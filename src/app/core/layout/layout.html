<div class="layout-container">

  <header class="navbar">
    <div class="navbar-left">
      <button class="btn-menu lg-hidden" (click)="toggleSidebar()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
      </button>
      <a routerLink="/" class="brand-logo">ğŸš€ DevPortfolio</a>
    </div>

    <div class="navbar-right">
      @if (currentUser(); as user) {
        <div class="user-badge" [title]="user.role">
          <span class="role-pill" [class]="user.role">{{ user.role | uppercase }}</span>
          <img [src]="user.photoURL || 'https://ui-avatars.com/api/?background=random&name='+user.email" class="avatar-circle">
        </div>
      } @else {
        <a routerLink="/auth/login" class="btn-login">Ingresar</a>
      }
    </div>
  </header>

  <div class="body-wrapper">
    
    <aside class="sidebar" [class.open]="isSidebarOpen()">
      <div class="sidebar-header lg-hidden">
        <span>MenÃº</span>
        <button (click)="closeSidebar()">Ã—</button>
      </div>

      <nav class="nav-links">
        <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}" (click)="closeSidebar()">
          ğŸ  Inicio
        </a>

        @if (currentUser()?.role === 'programmer') {
          <div class="nav-divider">PROGRAMADOR</div>
          <a routerLink="/projects" routerLinkActive="active" (click)="closeSidebar()">ğŸ“‚ Mis Proyectos</a>
          <a routerLink="/advice-requests" routerLinkActive="active" (click)="closeSidebar()">ğŸ“¬ Solicitudes</a>
          <a routerLink="/profile" routerLinkActive="active" (click)="closeSidebar()">âœï¸ Editar Perfil</a>
        }

        @if (currentUser()?.role === 'admin') {
          <div class="nav-divider">ADMINISTRACIÃ“N</div>
          <a routerLink="/admin" routerLinkActive="active" (click)="closeSidebar()">ğŸ›¡ï¸ Panel Admin</a>
        }

       @if (currentUser()) {
          <div class="nav-divider">CUENTA</div>
          
          <a routerLink="/my-requests" routerLinkActive="active" (click)="closeSidebar()">
            ğŸ“¦ Mis Solicitudes
          </a>
          
          <button (click)="logout()" class="btn-logout">ğŸšª Cerrar SesiÃ³n</button>
        }
      </nav>
    </aside>

    @if (isSidebarOpen()) { <div class="overlay lg-hidden" (click)="closeSidebar()"></div> }

    <main class="main-content">
      
      <div class="page-container">
        <router-outlet></router-outlet>
      </div>

      <app-footer></app-footer>
    </main>

  </div>
</div>